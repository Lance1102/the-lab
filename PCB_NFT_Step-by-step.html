<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IEC 60335 PCB Compliance Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f3f4f6; color: #1f2937; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin: 0 auto; height: 300px; max-height: 400px; }
        .card { transition: all 0.3s ease; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .step-active { border-left: 4px solid #3b82f6; background-color: #eff6ff; }
        .step-inactive { border-left: 4px solid transparent; opacity: 0.6; }
        .hidden-section { display: none; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
    <!-- Chosen Palette: Professional Compliance Blue - Cool Neutrals (Slate/Gray) for structure, Blue (#3b82f6) for primary actions/info, Green for pass/compliance, Amber for warning/testing required. -->
    <!-- Application Structure Plan: 
         1. Header: Context setting for IEC 60335 Clause 30 & Annex E.
         2. Interactive Wizard (The Decision Engine): The core tool. Users answer Qs about their PCB (Laminate vs Finished, UL File type). It outputs a "Pass" or "Test Required" verdict.
         3. Visual Analysis: A section visualizing WHY V-0 is accepted (comparing test severities).
         4. Knowledge Base: Detailed breakdown of "Base Material" vs "Finished Board" and UL Categories (ZPMV2 vs QMTS2).
    -->
    <!-- Visualization & Content Choices:
         - Decision Tree: Implemented as a JS-driven step-by-step wizard (No SVG).
         - Severity Chart: Chart.js Bar Chart comparing Glow Wire, Needle Flame, and V-0 criteria (conceptual duration/severity) to justify exemptions.
         - Status Indicators: CSS/HTML cards with color coding.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50 min-h-screen flex flex-col">

    <!-- Navigation / Header -->
    <header class="bg-white shadow-sm border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="h-8 w-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-lg">60335</div>
                <h1 class="text-xl font-bold text-slate-800 tracking-tight">PCB é˜»ç‡ƒåˆè¦åŠ©æ‰‹ <span class="text-sm font-normal text-slate-500 hidden sm:inline-block">| IEC 60335-1 ç¬¬30æ¢æ¬¾ & é™„éŒ„E</span></h1>
            </div>
            <nav class="hidden md:flex space-x-6 text-sm font-medium text-slate-600">
                <button onclick="scrollToSection('wizard')" class="hover:text-blue-600 transition">åˆ¤å®šç²¾éˆ</button>
                <button onclick="scrollToSection('analysis')" class="hover:text-blue-600 transition">æ•¸æ“šåˆ†æ</button>
                <button onclick="scrollToSection('knowledge')" class="hover:text-blue-600 transition">çŸ¥è­˜åº«</button>
            </nav>
        </div>
    </header>

    <main class="flex-grow max-w-6xl mx-auto px-4 py-8 w-full space-y-12">

        <!-- Intro Section -->
        <section class="text-center max-w-3xl mx-auto mb-8">
            <h2 class="text-3xl font-bold text-slate-900 mb-4">å°åˆ·é›»è·¯æ¿ (PCB) é‡ç„°è©¦é©—è©•ä¼°</h2>
            <p class="text-lg text-slate-600 leading-relaxed">
                æ ¹æ“š IEC 60335-1 ç¬¬30æ¢æ¬¾ï¼Œéé‡‘å±¬ææ–™éœ€é€šéè€ç‡ƒæ¸¬è©¦ã€‚å°æ–¼ PCBï¼Œé€šå¸¸éœ€è¦é€²è¡Œ <strong>Needle Flame Test (NFT, é™„éŒ„E)</strong>ã€‚
                ä½†åœ¨ç‰¹å®šæ¢ä»¶ä¸‹ï¼ˆå¦‚å–å¾— UL 94 V-0ï¼‰ï¼Œå¯è±å…æ¸¬è©¦ã€‚æœ¬å·¥å…·å”åŠ©æ‚¨å¿«é€Ÿåˆ¤æ–·æ˜¯å¦éœ€è¦åŸ·è¡Œ NFTã€‚
            </p>
        </section>

        <!-- SECTION 1: Compliance Wizard (Interactive Core) -->
        <section id="wizard" class="bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden">
            <div class="bg-slate-900 px-6 py-4 border-b border-slate-800">
                <h3 class="text-lg font-semibold text-white flex items-center">
                    <span class="mr-2">âš¡</span> äº’å‹•åˆ¤å®šç²¾éˆ (Compliance Wizard)
                </h3>
            </div>
            
            <div class="p-6 md:p-8">
                <p class="mb-6 text-slate-600">è«‹å›ç­”ä»¥ä¸‹é—œæ–¼æ‚¨ PCB ä¾›æ‡‰å•†èˆ‡ UL èªè­‰ç‹€æ…‹çš„å•é¡Œï¼Œç³»çµ±å°‡è‡ªå‹•åˆ†ææ˜¯å¦éœ€è¦åŸ·è¡Œ IEC 60335 é‡ç„°è©¦é©—ã€‚</p>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Left: Questions -->
                    <div class="lg:col-span-2 space-y-4" id="question-container">
                        <!-- Questions injected by JS -->
                    </div>

                    <!-- Right: Live Verdict Panel -->
                    <div class="lg:col-span-1">
                        <div class="sticky top-24 bg-slate-50 rounded-xl p-6 border border-slate-200 transition-all duration-300" id="verdict-panel">
                            <h4 class="text-sm uppercase tracking-wide text-slate-500 font-bold mb-3">ç•¶å‰è©•ä¼°ç‹€æ…‹</h4>
                            <div id="verdict-status" class="text-4xl mb-4">ğŸ¤”</div>
                            <h5 id="verdict-title" class="text-xl font-bold text-slate-800 mb-2">ç­‰å¾…è¼¸å…¥...</h5>
                            <p id="verdict-desc" class="text-sm text-slate-600 mb-4">è«‹å®Œæˆå·¦å´å•é¡Œä»¥ç²å¾—è©•ä¼°å»ºè­°ã€‚</p>
                            
                            <!-- Dynamic Details Box -->
                            <div id="verdict-details" class="hidden text-sm bg-white p-3 rounded border border-slate-200 shadow-inner">
                                <ul class="list-disc pl-4 space-y-1 text-slate-700"></ul>
                            </div>

                            <button onclick="resetWizard()" class="mt-6 w-full py-2 px-4 bg-white border border-slate-300 text-slate-600 rounded-lg hover:bg-slate-50 text-sm font-medium transition">
                                é‡ç½®è©•ä¼°
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: Analysis & Visualization -->
        <section id="analysis" class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
            <!-- Introductory Text -->
            <div class="col-span-1 md:col-span-2">
                <h3 class="text-2xl font-bold text-slate-800 mb-2">ç‚ºä»€éº¼ V-0 å¯ä»¥è±å…æ¸¬è©¦ï¼Ÿ</h3>
                <p class="text-slate-600">
                    IEC 60335 æ¨™æº–æ‰¿èª UL 94 V-0 (æˆ– IEC 60695-11-10) çš„åš´è‹›åº¦é€šå¸¸æ¶µè“‹æˆ–è¶…éé‡ç„°è©¦é©—çš„è¦æ±‚ã€‚
                    ä¸‹æ–¹åœ–è¡¨æ¯”è¼ƒäº†ä¸åŒé˜»ç‡ƒç­‰ç´šçš„ç›¸å°è€ç‡ƒæ€§èƒ½èˆ‡æ¸¬è©¦åš´è‹›åº¦æŒ‡æ¨™ã€‚
                </p>
            </div>

            <!-- Chart Container -->
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                <h4 class="font-bold text-slate-700 mb-4 text-center">é˜»ç‡ƒç­‰ç´šåš´è‹›åº¦èˆ‡è±å…é–€æª»</h4>
                <div class="chart-container">
                    <canvas id="flameChart"></canvas>
                </div>
                <p class="text-xs text-center text-slate-400 mt-2">è¨»ï¼šæ•¸å€¼ç‚ºåŸºæ–¼æ¸¬è©¦æ™‚é–“èˆ‡é€šéæ¨™æº–çš„ç¶œåˆåš´è‹›åº¦æŒ‡æ•¸ (åƒ…ä¾›åƒè€ƒ)</p>
            </div>

            <!-- Explainer Text -->
            <div class="space-y-6">
                <div class="bg-blue-50 p-5 rounded-lg border-l-4 border-blue-500">
                    <h5 class="font-bold text-blue-800 mb-2">é—œéµè§€å¿µï¼šåŸºæ vs. æˆå“</h5>
                    <p class="text-sm text-blue-700 mb-2">
                        <strong>PCB åŸºæ (Laminate):</strong> å³ä½¿åŸºææœ¬èº«æ˜¯ V-0ï¼Œä¸€æ—¦ç¶“éåŠ å·¥ï¼ˆå°åˆ·ç·šè·¯ã€é˜»ç„Šå±¤/ç¶ æ¼† Solder Maskï¼‰ï¼Œå…¶é˜»ç‡ƒç‰¹æ€§å¯èƒ½æ”¹è®Šã€‚
                    </p>
                    <p class="text-sm text-blue-700">
                        <strong>IEC è¦æ±‚ï¼š</strong> é™¤éè­‰æ˜ã€Œæˆå“æ¿ã€ç¬¦åˆ V-0ï¼Œå¦å‰‡å¿…é ˆå°æˆå“é€²è¡Œé‡ç„°è©¦é©— (NFT)ã€‚é€™å°±æ˜¯ç‚ºä»€éº¼å–®ç´”çœ‹åŸºæé»ƒå¡ (QMTS2) å¸¸å¸¸ä¸å¤ çš„åŸå› ã€‚
                    </p>
                </div>

                <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm">
                    <h5 class="font-bold text-slate-800 mb-2">UL èªè­‰é¡åˆ¥è§£ç¢¼</h5>
                    <ul class="space-y-3 text-sm text-slate-600">
                        <li class="flex items-start">
                            <span class="bg-green-100 text-green-800 text-xs font-bold px-2 py-0.5 rounded mr-2 mt-0.5">ZPMV2</span>
                            <span><strong>Finished Board (æˆå“æ¿):</strong> è‹¥ä¾›æ‡‰å•†æä¾›æ­¤é¡åˆ¥çš„ E-Number ä¸”ç‚º V-0ï¼Œé€šå¸¸å¯ç›´æ¥è±å… NFTã€‚</span>
                        </li>
                        <li class="flex items-start">
                            <span class="bg-yellow-100 text-yellow-800 text-xs font-bold px-2 py-0.5 rounded mr-2 mt-0.5">QMTS2</span>
                            <span><strong>Laminate (åŸºå±¤æ¿):</strong> åƒ…ä»£è¡¨"æ²’æœ‰å°åˆ·"çš„æ¿æã€‚è‹¥æ‚¨çš„ PCB æœ‰ç¶ æ¼†/å°åˆ·ï¼Œä¸èƒ½ç›´æ¥å¼•ç”¨æ­¤èªè­‰ä¾†è±å… NFTã€‚</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- SECTION 3: Knowledge Base (Details) -->
        <section id="knowledge" class="space-y-6">
            <h3 class="text-2xl font-bold text-slate-800">å¸¸è¦‹å•é¡Œèˆ‡åˆ¤å®šç´°ç¯€</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Card 1 -->
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200 card">
                    <div class="text-3xl mb-4">ğŸ”</div>
                    <h4 class="font-bold text-lg text-slate-800 mb-2">åªæœ‰ UL Logo æ²’æœ‰è™Ÿç¢¼ï¼Ÿ</h4>
                    <p class="text-sm text-slate-600">
                        PCB ä¸Šåƒ…æœ‰ UL æ¨™èªŒ (Logo) æˆ– "94V-0" å­—æ¨£æ˜¯<strong>ä¸è¶³ä»¥</strong>ä½œç‚ºåˆè¦è­‰æ“šçš„ã€‚IEC 60335 è¦æ±‚å¯è¿½æº¯æ€§ã€‚æ‚¨å¿…é ˆè¦æ±‚ä¾›æ‡‰å•†æä¾›å…·é«”çš„ <strong>UL File Number (Exxxxxx)</strong> ä¸¦ä¸Šç¶²æ ¸å¯¦é»ƒå¡ (Yellow Card)ã€‚
                    </p>
                </div>

                <!-- Card 2 -->
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200 card">
                    <div class="text-3xl mb-4">ğŸ§ª</div>
                    <h4 class="font-bold text-lg text-slate-800 mb-2">é‡ç„°è©¦é©— (NFT) æ€éº¼åšï¼Ÿ</h4>
                    <p class="text-sm text-slate-600">
                        ä¾æ“š IEC 60695-11-5ã€‚ä½¿ç”¨ä¸çƒ·æ°£ç”¢ç”Ÿ 12mm é«˜çš„ç«ç„°ï¼Œæ–½åŠ æ–¼æ¨£å“æœ€è–„å¼±è™•ï¼ˆå¦‚é‚Šç·£ï¼‰æŒçºŒ <strong>10ç§’ æˆ– 30ç§’</strong> (è¦–æ¢æ¬¾è€Œå®š)ã€‚
                        <strong>åˆæ ¼æ¨™æº–ï¼š</strong> ç§»é–‹ç«ç„°å¾Œï¼Œç‡ƒç‡’æ™‚é–“ä¸è¶…é 30ç§’ï¼Œä¸”æ»´è½ç‰©ä¸å¼•ç‡ƒåº•å±¤è¡›ç”Ÿç´™ã€‚
                    </p>
                </div>

                <!-- Card 3 -->
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200 card">
                    <div class="text-3xl mb-4">ğŸ›¡ï¸</div>
                    <h4 class="font-bold text-lg text-slate-800 mb-2">Solder Mask (é˜»ç„Šå±¤) çš„å½±éŸ¿</h4>
                    <p class="text-sm text-slate-600">
                        æœ‰äº›èªè­‰æ©Ÿæ§‹å…è¨±ï¼šå¦‚æœåŸºææ˜¯ V-0 (QMTS2)ï¼Œä¸”ä½¿ç”¨çš„æ²¹å¢¨/é˜»ç„Šå±¤ä¹Ÿå–®ç¨å–å¾—äº† UL 94 V-0 èªè­‰ (é¡åˆ¥ QMFZ2)ï¼Œå‰‡å¯èƒ½æ¥å—"çµ„åˆ"åˆè¦ã€‚ä½†æœ€ä¿éšªçš„æ–¹å¼ä»æ˜¯é€²è¡Œæˆå“æ¿çš„ NFTã€‚
                    </p>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-slate-400 py-8 mt-12">
        <div class="max-w-6xl mx-auto px-4 text-center text-sm">
            <p class="mb-2">IEC 60335 PCB Compliance Assistant Â© 2023</p>
            <p>æœ¬å·¥å…·åƒ…ä¾›è¼”åŠ©åƒè€ƒï¼Œæœ€çµ‚åˆè¦æ€§è«‹ä»¥å®˜æ–¹å¯¦é©—å®¤å ±å‘Šèˆ‡æ¨™æº–åŸæ–‡ (IEC 60335-1) ç‚ºæº–ã€‚</p>
        </div>
    </footer>

    <!-- JavaScript Application Logic -->
    <script>
        // --- DATA & STATE ---
        const state = {
            currentStep: 0,
            answers: {},
            history: []
        };

        // Decision Tree Logic
        const decisionTree = [
            {
                id: 'q1',
                text: "Q1: æ‚¨æ‰‹ä¸Šçš„ PCB ä¾›æ‡‰å•†æ˜¯å¦æä¾›äº† UL èªè­‰è™Ÿç¢¼ (File Number, å¦‚ E123456)ï¼Ÿ",
                options: [
                    { label: "æœ‰ï¼Œæˆ‘æœ‰ UL è™Ÿç¢¼", value: "yes", next: 'q2' },
                    { label: "æ²’æœ‰ï¼Œåªæœ‰ UL Logo æˆ– V-0 å°å­—", value: "no", next: 'result_no_trace' }
                ]
            },
            {
                id: 'q2',
                text: "Q2: æŸ¥è©¢è©²è™Ÿç¢¼ (UL Product iQ) å¾Œï¼Œè©²èªè­‰å±¬æ–¼å“ªå€‹é¡åˆ¥ (Category)ï¼Ÿ",
                note: "æç¤ºï¼šæŸ¥çœ‹é»ƒå¡é ‚éƒ¨çš„ 'Category Name'ã€‚",
                options: [
                    { label: "ZPMV2 / ZPMV8 (Wiring, Printed - Component)", value: "ZPMV2", next: 'q3_finished' },
                    { label: "QMTS2 (Industrial Laminates - Component)", value: "QMTS2", next: 'q3_laminate' },
                    { label: "ä¸ç¢ºå®š / å…¶ä»–é¡åˆ¥", value: "unknown", next: 'result_manual' }
                ]
            },
            {
                id: 'q3_finished',
                text: "Q3 (æˆå“æ¿ ZPMV2): è©²é»ƒå¡ä¸Šçš„ç‡ƒç‡’ç­‰ç´š (Flammability Rating) æ˜¯ï¼Ÿ",
                options: [
                    { label: "V-0 æˆ– V-1", value: "v0", next: 'result_pass' },
                    { label: "V-2, HB æˆ–æ›´ä½", value: "low", next: 'result_nft_req' }
                ]
            },
            {
                id: 'q3_laminate',
                text: "Q3 (åŸºæ QMTS2): æ‚¨çš„å¯¦éš› PCB æˆå“æ˜¯å¦æœ‰å°åˆ·ã€ç¶ æ¼† (Solder Mask) æˆ–å…¶ä»–è¦†è“‹å±¤ï¼Ÿ",
                options: [
                    { label: "æ˜¯ï¼Œæœ‰å°åˆ·/ç¶ æ¼† (çµ•å¤§å¤šæ•¸æƒ…æ³)", value: "printed", next: 'result_check_mask' },
                    { label: "å¦ï¼Œé€™æ˜¯å®Œå…¨è£¸æ¿ (è•åˆ»å¾Œç„¡ä»»ä½•æ²¹å¢¨)", value: "bare", next: 'result_pass_bare' }
                ]
            }
        ];

        const results = {
            'result_pass': {
                title: "è±å…æ¸¬è©¦ (Exempt)",
                status: "âœ…",
                desc: "æ‚¨çš„ PCB å±¬æ–¼å·²èªè­‰çš„æˆå“æ¿ (ZPMV2) ä¸”é”åˆ°äº† V-0/V-1 ç­‰ç´šã€‚",
                details: [
                    "ä¾æ“š IEC 60335-1 ç¬¬ 30.2 æ¢æ¬¾ï¼Œææ–™åˆ†ç´šç‚º V-0 æˆ– V-1 ä¸éœ€é€²è¡Œé‡ç„°è©¦é©—ã€‚",
                    "è«‹ä¿å­˜è©² UL é»ƒå¡ä½œç‚ºæŠ€è¡“æ–‡ä»¶ (Technical Construction File)ã€‚"
                ],
                color: "green"
            },
            'result_pass_bare': {
                title: "è±å…æ¸¬è©¦ (Exempt)",
                status: "âœ…",
                desc: "åŸºæç‚º V-0 ä¸”ç„¡é¡å¤–å¯ç‡ƒå°åˆ·å±¤ï¼Œè¦–ç‚ºç¬¦åˆ V-0ã€‚",
                details: [
                    "å› ç‚ºæ²’æœ‰æ·»åŠ é¡å¤–çš„æœ‰æ©Ÿç‰©(æ²¹å¢¨)ï¼ŒåŸºæçš„ V-0 ç‰¹æ€§å¾—ä»¥ä¿ç•™ã€‚",
                    "è«‹ç¢ºä¿ç”Ÿç”¢éç¨‹æœªå¼•å…¥å…¶ä»–æ˜“ç‡ƒå¡—å±¤ã€‚"
                ],
                color: "green"
            },
            'result_nft_req': {
                title: "éœ€åŸ·è¡Œé‡ç„°è©¦é©— (Test Required)",
                status: "ğŸ”¥",
                desc: "PCB é˜»ç‡ƒç­‰ç´šä¸è¶³ (å¦‚ HB/V-2)ï¼Œå¿…é ˆé€²è¡Œ IEC 60695-11-5 é‡ç„°è©¦é©—ã€‚",
                details: [
                    "IEC 60335 è¦æ±‚ï¼šéé‡‘å±¬ææ–™è‹¥é V-0/V-1ï¼Œå‰‡éœ€é€šéé‡ç„°æ¸¬è©¦ã€‚",
                    "æ¸¬è©¦æ¢ä»¶ï¼šä¾æ“šç”¢å“é¡åˆ¥ï¼Œé€šå¸¸æ–½åŠ ç«ç„° 10ç§’ æˆ– 30ç§’ã€‚",
                    "åˆæ ¼åˆ¤å®šï¼šç‡ƒç‡’æ™‚é–“ < 30ç§’ï¼Œä¸”æ»´è½ç‰©ä¸å¼•ç‡ƒã€‚"
                ],
                color: "red"
            },
            'result_check_mask': {
                title: "é«˜æ©Ÿç‡éœ€æ¸¬è©¦ (Likely Test Required)",
                status: "âš ï¸",
                desc: "æ‚¨åƒ…æŒæœ‰ã€ŒåŸºæã€çš„ V-0 è­‰æ˜ï¼Œä½†ã€Œæˆå“ã€æœ‰å°åˆ·å±¤ã€‚",
                details: [
                    "åŸºæçš„ QMTS2 èªè­‰ä¸åŒ…å«ç¶ æ¼†/æ²¹å¢¨çš„ç‡ƒç‡’ç‰¹æ€§ã€‚",
                    "**å»ºè­°åšæ³• 1 (æ­£è¦):** é€æ¨£é€²è¡Œæˆå“ PCB çš„é‡ç„°è©¦é©— (NFT)ã€‚",
                    "**å»ºè­°åšæ³• 2 (æ–‡ä»¶å¯©æŸ¥):** è‹¥ç¶ æ¼†æœ¬èº«ä¹Ÿæœ‰ V-0 è­‰æ˜ (QMFZ2)ï¼Œéƒ¨åˆ†é©—è­‰å–®ä½å¯èƒ½æ¥å—ï¼Œä½†ä¾æ¢æ¬¾åš´æ ¼è§£é‡‹ä»éœ€åš NFTã€‚",
                    "**çµè«–ï¼š** ç„¡æ³•ç›´æ¥è±å…ï¼Œé™¤éè­‰æ˜æˆå“ä»ç‚º V-0ã€‚"
                ],
                color: "amber"
            },
            'result_no_trace': {
                title: "è³‡æ–™ä¸è¶³ (Insufficient Data)",
                status: "ğŸš«",
                desc: "åƒ…æœ‰ Logo ç„¡æ³•è­‰æ˜åˆè¦æ€§ã€‚",
                details: [
                    "IEC 60335 è¦æ±‚é›¶ä»¶éœ€æœ‰å¯è¿½æº¯æ€§ã€‚",
                    "è«‹è¯ç¹«ä¾›æ‡‰å•†ç´¢å–å…·é«”çš„ UL File Numberã€‚",
                    "è‹¥ç„¡æ³•å–å¾—ï¼Œå¿…é ˆå°‡è©² PCB è¦–ç‚ºæœªèªè­‰ææ–™ï¼Œç›´æ¥é€²è¡Œé‡ç„°è©¦é©—ã€‚"
                ],
                color: "gray"
            },
            'result_manual': {
                title: "éœ€äººå·¥åˆ¤å®š (Manual Check)",
                status: "ğŸ§",
                desc: "UL é¡åˆ¥ä¸å°‹å¸¸ï¼Œå»ºè­°è«®è©¢ç™¼è­‰å–®ä½ã€‚",
                details: [
                    "è«‹ç¢ºèª UL é»ƒå¡æ˜¯å¦é©ç”¨æ–¼è©²åšåº¦çš„ PCBã€‚",
                    "è‹¥ä¸ç¢ºå®šï¼ŒåŸ·è¡Œé‡ç„°è©¦é©—æ˜¯æœ€ä¿éšªçš„åˆè¦è·¯å¾‘ã€‚"
                ],
                color: "blue"
            }
        };

        // --- WIZARD RENDER LOGIC ---

        function renderQuestion(stepId) {
            const qData = decisionTree.find(q => q.id === stepId);
            if (!qData) return;

            const container = document.getElementById('question-container');
            
            // Create Step Element
            const stepDiv = document.createElement('div');
            stepDiv.className = "fade-in bg-slate-50 p-4 rounded-lg border border-slate-200 mb-4";
            stepDiv.id = `step-${stepId}`;
            
            let html = `<h5 class="font-bold text-slate-800 mb-3">${qData.text}</h5>`;
            if (qData.note) {
                html += `<p class="text-xs text-slate-500 mb-3 bg-white p-2 rounded border border-slate-100">${qData.note}</p>`;
            }
            html += `<div class="flex flex-wrap gap-2">`;
            
            qData.options.forEach(opt => {
                html += `<button onclick="handleAnswer('${stepId}', '${opt.value}', '${opt.next}')" 
                         class="px-4 py-2 rounded-md bg-white border border-slate-300 shadow-sm hover:bg-blue-50 hover:border-blue-400 text-slate-700 transition">
                         ${opt.label}
                         </button>`;
            });
            html += `</div>`;
            
            stepDiv.innerHTML = html;
            container.appendChild(stepDiv);
        }

        function handleAnswer(currentId, value, nextId) {
            // Disable buttons in current step
            const currentStepDiv = document.getElementById(`step-${currentId}`);
            const buttons = currentStepDiv.querySelectorAll('button');
            buttons.forEach(btn => {
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
                if(!btn.textContent.includes(decisionTree.find(q=>q.id===currentId).options.find(o=>o.value===value).label)) {
                    btn.style.display = 'none'; // Hide unselected
                } else {
                    btn.classList.remove('bg-white', 'opacity-50');
                    btn.classList.add('bg-blue-600', 'text-white', 'border-blue-700'); // Highlight selected
                }
            });

            // Check if result
            if (results[nextId]) {
                showResult(results[nextId]);
            } else {
                renderQuestion(nextId);
            }
        }

        function showResult(resultData) {
            const panel = document.getElementById('verdict-panel');
            const status = document.getElementById('verdict-status');
            const title = document.getElementById('verdict-title');
            const desc = document.getElementById('verdict-desc');
            const detailsBox = document.getElementById('verdict-details');
            const detailsList = detailsBox.querySelector('ul');

            // Style Updates
            const borderColors = { green: 'border-green-500', red: 'border-red-500', amber: 'border-amber-500', gray: 'border-gray-400', blue: 'border-blue-400' };
            const bgColors = { green: 'bg-green-50', red: 'bg-red-50', amber: 'bg-amber-50', gray: 'bg-slate-50', blue: 'bg-blue-50' };
            
            panel.className = `sticky top-24 rounded-xl p-6 border-l-8 shadow-lg transition-all duration-300 ${borderColors[resultData.color]} ${bgColors[resultData.color]}`;

            status.textContent = resultData.status;
            title.textContent = resultData.title;
            desc.textContent = resultData.desc;

            // Details
            detailsList.innerHTML = '';
            resultData.details.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = item; // Allow HTML in details
                detailsList.appendChild(li);
            });
            detailsBox.classList.remove('hidden');
        }

        function resetWizard() {
            document.getElementById('question-container').innerHTML = '';
            document.getElementById('verdict-details').classList.add('hidden');
            
            // Reset Verdict Panel
            const panel = document.getElementById('verdict-panel');
            panel.className = "sticky top-24 bg-slate-50 rounded-xl p-6 border border-slate-200 transition-all duration-300";
            document.getElementById('verdict-status').textContent = "ğŸ¤”";
            document.getElementById('verdict-title').textContent = "ç­‰å¾…è¼¸å…¥...";
            document.getElementById('verdict-desc').textContent = "è«‹å®Œæˆå·¦å´å•é¡Œä»¥ç²å¾—è©•ä¼°å»ºè­°ã€‚";

            // Restart
            renderQuestion('q1');
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // --- CHART JS ---
        function initChart() {
            const ctx = document.getElementById('flameChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['HB (æ°´å¹³ç‡ƒç‡’)', 'V-2', 'V-1', 'V-0', 'Needle Flame (é‡ç„°)'],
                    datasets: [{
                        label: 'é˜»ç‡ƒåš´è‹›åº¦æŒ‡æ•¸ (Severity Index)',
                        data: [20, 40, 70, 90, 85], // Conceptual values
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.6)',  // Red for HB
                            'rgba(245, 158, 11, 0.6)', // Amber for V-2
                            'rgba(59, 130, 246, 0.6)', // Blue for V-1
                            'rgba(16, 185, 129, 0.8)', // Green for V-0 (High Pass)
                            'rgba(99, 102, 241, 0.6)'  // Indigo for NFT Reference
                        ],
                        borderColor: [
                            'rgb(239, 68, 68)',
                            'rgb(245, 158, 11)',
                            'rgb(59, 130, 246)',
                            'rgb(16, 185, 129)',
                            'rgb(99, 102, 241)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: { display: true, text: 'ç›¸å°é˜²è­·èƒ½åŠ› / æ¸¬è©¦æ¨™æº–é«˜ä½' },
                            ticks: { display: false } // Hide numbers as this is conceptual
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const msgs = [
                                        "HB: åƒ…è¦æ±‚æ°´å¹³ç‡ƒç‡’é€Ÿåº¦ï¼Œæœ€å¯¬é¬†ã€‚",
                                        "V-2: å…è¨±æ»´è½ç‰©å¼•ç‡ƒæ£‰èŠ±ã€‚",
                                        "V-1: ä¸å…è¨±æ»´è½ç‰©å¼•ç‡ƒï¼Œé¤˜ç„° < 30sã€‚",
                                        "V-0: æœ€åš´æ ¼ï¼Œé¤˜ç„° < 10sï¼Œç„¡å¼•ç‡ƒæ»´è½ã€‚",
                                        "NFT: æ¨¡æ“¬æ•…éšœç«æºï¼Œè¦æ±‚é¡ä¼¼ V-1/V-0ã€‚"
                                    ];
                                    return msgs[context.dataIndex];
                                }
                            }
                        },
                        legend: { display: false }
                    }
                }
            });
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            renderQuestion('q1');
            initChart();
        });

    </script>
</body>
</html>